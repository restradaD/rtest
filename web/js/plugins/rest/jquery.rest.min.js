(function(h,k,f,c){var m,a,i,n,e,p,j,d,o,g,l,b;j=function(q){throw"ERROR: jquery.rest: "+q};o=function(r){var q;q="";while(r-->0){q+="  "}return q};p=function(q){if(!h.btoa){j("You need a polyfill for 'btoa' to use basic auth.")}return h.btoa(q)};g=function(q){if(!h.JSON){j("You need a polyfill for 'JSON' to use stringify.")}return h.JSON.stringify(q)};d=function(r,q){var s;s=function(){};s.prototype=r;return f.extend(true,new s(),q)};l=function(q){if(!(q&&f.isPlainObject(q))){return false}f.each(q,function(r){if(n[r]===c){return j("Unknown option: '"+r+"'")}});return null};b=function(q,r){if("string"!==f.type(r)){return j("'"+q+"' must be a string")}};e=function(){return alert('"delete()" has been deprecated. Please use "destroy()" or "del()" instead.')};n={url:"",cache:0,request:function(r,q){return f.ajax(q)},cachableMethods:["GET"],methodOverride:false,stringifyData:false,stripTrailingSlash:false,password:null,username:null,verbs:{create:"POST",read:"GET",update:"PUT",destroy:"DELETE"},ajax:{dataType:"json"}};m=(function(){function q(r){this.parent=r;this.c={}}q.prototype.valid=function(r){var s;s=new Date().getTime()-r.getTime();return s<=this.parent.opts.cache*1000};q.prototype.key=function(s){var r,t=this;r="";f.each(s,function(w,u){return r+=w+"="+(f.isPlainObject(u)?"{"+t.key(u)+"}":u)+"|"});return r};q.prototype.get=function(s){var r;r=this.c[s];if(!r){return}if(this.valid(r.created)){return r.data}};q.prototype.put=function(r,s){return this.c[r]={created:new Date(),data:s}};q.prototype.clear=function(r){var s=this;if(r){return f.each(this.c,function(t){if(t.match(r)){return delete s.c[t]}})}else{return this.c={}}};return q})();i=(function(){function q(s,u,r,t){this.name=s;this.method=u;if(r==null){r={}}this.parent=t;b("name",this.name);b("method",this.method);l(r);if(this.parent[this.name]){j("Cannot add Verb: '"+s+"' already exists")}this.method=u.toUpperCase();if(!r.url){r.url=""}this.opts=d(this.parent.opts,r);this.root=this.parent.root;this.custom=!n.verbs[this.name];this.call=f.proxy(this.call,this);this.call.instance=this}q.prototype.call=function(){var t,r,s;s=this.parent.extractUrlData(this.method,arguments),r=s.url,t=s.data;if(this.custom){r+=this.opts.url||this.name}return this.parent.ajax.call(this,this.method,r,t)};q.prototype.show=function(r){return console.log(o(r)+this.name+": "+this.method)};return q})();a=(function(){function q(t,r,s){if(r==null){r={}}l(r);if(s&&s instanceof q){this.name=t;b("name",this.name);this.constructChild(s,r)}else{this.url=t||"";b("url",this.url);this.constructRoot(r)}}q.prototype.constructRoot=function(r){this.opts=d(n,r);this.root=this;this.numParents=0;this.urlNoId=this.url;this.cache=new m(this);this.parent=null;return this.name=this.opts.name||"ROOT"};q.prototype.constructChild=function(s,r){this.parent=s;b("name",this.name);if(!(this.parent instanceof q)){this.error("Invalid parent")}if(this.parent[this.name]){this.error("'"+name+"' already exists")}if(!r.url){r.url=""}this.opts=d(this.parent.opts,r);this.root=this.parent.root;this.numParents=this.parent.numParents+1;this.urlNoId=this.parent.url+(""+(this.opts.url||this.name)+"/");this.url=this.urlNoId+(":ID_"+this.numParents+"/");f.each(this.opts.verbs,f.proxy(this.addVerb,this));if(this.destroy){this.del=this.destroy;return this["delete"]=e}};q.prototype.error=function(r){return j("Cannot add Resource: "+r)};q.prototype.add=function(s,r){return this[s]=new q(s,r,this)};q.prototype.addVerb=function(s,t,r){return this[s]=new i(s,t,r,this).call};q.prototype.show=function(r){if(r==null){r=0}if(r>25){j("Plugin Bug! Recursion Fail")}if(this.name){console.log(o(r)+this.name+": "+this.url)}f.each(this,function(s,t){if(f.type(t)==="function"&&t.instance instanceof i&&s!=="del"){return t.instance.show(r+1)}});f.each(this,function(s,t){if(s!=="parent"&&s!=="root"&&t instanceof q){return t.show(r+1)}});return null};q.prototype.toString=function(){return this.name};q.prototype.extractUrlData=function(J,u){var x,D,y,I,C,A,B,w,F,E,z,v,s,r,G,H;B=[];I=null;E=null;for(s=0,G=u.length;s<G;s++){x=u[s];z=f.type(x);if(z==="string"||z==="number"){B.push(x)}else{if(z==="object"&&I===null){I=x}else{if(z==="object"&&E===null){E=x}else{j(("Invalid argument: "+x+" ("+z+").")+" Must be strings or ints (IDs) followed by one optional object and one optional query params object.")}}}}F=B.length;D=J!=="create";y=J!=="update"&&J!=="delete";v=null;if(D&&F===this.numParents){v=this.url}if(y&&F===this.numParents-1){v=this.urlNoId}if(v===null){if(y){w=this.numParents-1}if(D){w=(w?w+" or ":"")+this.numParents}j("Invalid number of ID arguments, required "+w+", provided "+F)}for(C=r=0,H=B.length;r<H;C=++r){A=B[C];v=v.replace(new RegExp("/:ID_"+(C+1)+"/"),"/"+A+"/")}if(E){v+="?"+(f.param(E))}return{url:v,data:I}};q.prototype.ajax=function(r,t,w){var y,v,u,A,z,s,x=this;if(!r){j("method missing")}if(!t){j("url missing")}u={};if(this.opts.username&&this.opts.password){v=p(this.opts.username+":"+this.opts.password);u.Authorization="Basic "+v}if(w&&this.opts.stringifyData){w=g(w);u["Content-Type"]="application/json"}if(this.opts.methodOverride&&(r!=="GET"&&r!=="HEAD"&&r!=="POST")){u["X-HTTP-Method-Override"]=r;r="POST"}if(this.opts.stripTrailingSlash){t=t.replace(/\/$/,"")}y={url:t,type:r,headers:u};if(w){if("POST"===y.type||"PUT"===y.type){w=JSON.stringify(w)}y.data=w}y=f.extend(true,{},this.opts.ajax,y);s=this.opts.cache&&f.inArray(r,this.opts.cachableMethods)>=0;if(s){A=this.root.cache.key(y);z=this.root.cache.get(A);if(z){return z}}z=this.opts.request(this.parent,y);if(s){z.done(function(){return x.root.cache.put(A,z)})}return z};return q})();a.defaults=n;f.RestClient=a}(window,document,jQuery));